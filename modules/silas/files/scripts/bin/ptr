#!/usr/bin/env ruby

require 'rubygems'
require 'erubis'

options = {}
path_list = []

ARGV.each do|arg|
  if arg.include? '=' then
    key, value = arg.split('=', 2)
    options[key] = eval value
  else
    path_list << arg
  end
end

if path_list.length < 1 then
  puts 'Usage: ptr [options] path...'
  exit 1
end

path_list.each do|path|
  file = File.new(path, 'r')
  template = file.read
  file.close

  render = Erubis::Eruby.new(template)
  puts render.result(options)
end
